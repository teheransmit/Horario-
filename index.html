<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Horario</title>
  <!-- Fuente moderna -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #121212;
      --bg-card: #1f1f1f;
      --accent: #4f93ff;
      --accent-light: #6aa7ff;
      --text-light: #e0e0e0;
      --text-dark: #212121;
      --border-color: #333;
      --shadow: rgba(0, 0, 0, 0.5);
    }
    * {
      box-sizing: border-box;
      transition: all 0.2s ease;
    }
    body {
      margin: 0;
      background-color: var(--bg-dark);
      color: var(--text-light);
      font-family: 'Inter', sans-serif;
      padding: 20px;
    }
    h1 {
      margin: 0;
      background: linear-gradient(135deg, var(--accent), var(--accent-light));
      color: white;
      padding: 16px;
      text-align: center;
      border-radius: 8px;
      box-shadow: 0 4px 12px var(--shadow);
      font-weight: 700;
    }
    .formulario {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      background-color: var(--bg-card);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px var(--shadow);
      margin-top: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: var(--text-light);
    }
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background-color: #2a2a2a;
      color: var(--text-light);
      font-size: 0.95em;
    }
    .form-group input:focus,
    .form-group select:focus {
      outline: 2px solid var(--accent-light);
    }
    .formulario button {
      padding: 12px;
      background: var(--accent);
      border: none;
      border-radius: 6px;
      color: white;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 6px var(--shadow);
    }
    .formulario button:hover {
      background: var(--accent-light);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: var(--bg-card);
      border-radius: 8px;
      box-shadow: 0 4px 12px var(--shadow);
    }
    thead th {
      background-color: #2a2a2a;
      color: var(--accent-light);
      font-weight: 600;
      padding: 12px;
      border: 1px solid var(--border-color);
    }
    tbody td {
      border: 1px solid var(--border-color);
      padding: 8px;
      vertical-align: top;
      height: 50px;
      background-clip: padding-box;
    }
    tbody td:first-child {
      font-weight: 600;
      color: var(--accent-light);
      background-color: #2a2a2a;
    }
    tbody tr:nth-child(even) td:not(:first-child) {
      background-color: #242424;
    }
    .clase {
      display: block;
      max-width: 100%;
      height: auto;
      color: var(--text-dark);
      font-weight: 600;
      font-size: 0.75em;
      padding: 2px 4px;
      margin: 2px 0;
      cursor: move;
      white-space: pre-line;
      border-radius: 6px;
      box-shadow: 0 1px 2px var(--shadow);
      box-sizing: border-box;
      text-align: center;
    }
    .clase:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 8px var(--shadow);
    }
  </style>
</head>
<body>
  <h1>Horario de Clases</h1>
  <div class="formulario">
    <div class="form-group">
      <label for="materia">Materia</label>
      <input type="text" id="materia" placeholder="Nombre de la materia">
    </div>
    <div class="form-group">
      <label for="nrc">NRC</label>
      <input type="text" id="nrc" placeholder="Código NRC">
    </div>
    <div class="form-group">
      <label for="profesor">Profesor</label>
      <input type="text" id="profesor" placeholder="Nombre del profesor">
    </div>
    <div class="form-group">
      <label for="dia">Día</label>
      <select id="dia">
        <option>Lunes</option>
        <option>Martes</option>
        <option>Miércoles</option>
        <option>Jueves</option>
        <option>Viernes</option>
        <option>Sábado</option>
      </select>
    </div>
    <div class="form-group">
      <label for="horaInicio">Hora inicio</label>
      <select id="horaInicio"></select>
    </div>
    <div class="form-group">
      <label for="horaFin">Hora fin</label>
      <select id="horaFin"></select>
    </div>
    <div class="form-group">
      <button onclick="agregarClase()">Agregar Clase</button>
    </div>
  </div>

  <table id="horario">
    <thead>
      <tr>
        <th>Hora</th>
        <th>Lunes</th>
        <th>Martes</th>
        <th>Miércoles</th>
        <th>Jueves</th>
        <th>Viernes</th>
        <th>Sábado</th>
      </tr>
    </thead>
    <tbody id="tabla-cuerpo"></tbody>
  </table>

  <script>
    const coloresMaterias = {};
    const coloresDisponibles = ['#FF8A80', '#FFD180', '#FFFF8D', '#CCFF90', '#A7FFEB', '#80D8FF', '#82B1FF', '#B388FF', '#F8BBD0', '#D7CCC8'];
    let count = 0;

    function generarHoras() {
      const ops = [];
      for (let h = 6; h <= 21; h++) {
        for (let m = 0; m < 60; m += 10) {
          ops.push(`${String(h).padStart(2,'0')}:${String(m).padStart(2,'00')}`);
        }
      }
      return ops;
    }

    const horas = generarHoras();
    const horasFilas = horas.filter(h => h.endsWith(':00'));

    const selIni = document.getElementById('horaInicio');
    const selFin = document.getElementById('horaFin');
    horas.forEach(h => [selIni, selFin].forEach(sel => {
      const o = document.createElement('option');
      o.value = h;
      o.textContent = h;
      sel.appendChild(o);
    }));

    const body = document.getElementById('tabla-cuerpo');
    horasFilas.forEach(h => {
      const row = document.createElement('tr');
      let html = `<td>${h}</td>`;
      ['Lunes','Martes','Miércoles','Jueves','Viernes','Sábado'].forEach(d => {
        html += `<td data-dia="${d}" data-hora="${h}" ondragover="allowDrop(event)" ondrop="drop(event)"></td>`;
      });
      row.innerHTML = html;
      body.appendChild(row);
    });

    function allowDrop(e) { e.preventDefault(); }
    function drag(e) { e.dataTransfer.setData('text/plain', e.target.id); }
    function drop(e) {
      e.preventDefault();
      const id = e.dataTransfer.getData('text/plain');
      const el = document.getElementById(id);
      if (e.target.tagName === 'TD') e.target.appendChild(el);
    }

    function obtenerColorParaMateria(nombre) {
      if (!coloresMaterias[nombre]) {
        coloresMaterias[nombre] = coloresDisponibles[Object.keys(coloresMaterias).length % coloresDisponibles.length];
      }
      return coloresMaterias[nombre];
    }

    function agregarClase() {
      const mat = document.getElementById('materia').value.trim();
      const nrc = document.getElementById('nrc').value.trim();
      const prof = document.getElementById('profesor').value.trim();
      const dia = document.getElementById('dia').value;
      const ini = document.getElementById('horaInicio').value;
      const fin = document.getElementById('horaFin').value;
      if (!mat || !nrc) return alert('Completa Materia y NRC');

      const color = obtenerColorParaMateria(mat);
      const startHour = parseInt(ini.split(':')[0], 10);
      const endHour = parseInt(fin.split(':')[0], 10);

      horasFilas.forEach(h => {
        const hHour = parseInt(h.split(':')[0], 10);
        if (hHour >= startHour && hHour < endHour) {
          const cell = document.querySelector(`td[data-dia="${dia}"][data-hora="${h}"]`);
          if (cell) {
            const div = document.createElement('div');
            div.className = 'clase';
            div.textContent = `${mat}\n${nrc}\n${prof}`;
            div.draggable = true;
            div.id = 'clase-' + (count++);
            div.style.backgroundColor = color;
            div.addEventListener('dragstart', drag);
            div.addEventListener('contextmenu', e => {
              e.preventDefault();
              editarClase(div);
            });
            cell.appendChild(div);
          }
        }
      });
    }

    function editarClase(elemento) {
      const contenido = elemento.textContent.split('\n');
      const [materia, nrc, profesor] = contenido;
      const nuevoMat = prompt('Editar Materia:', materia);
      const nuevoNrc = prompt('Editar NRC:', nrc);
      const nuevoProf = prompt('Editar Profesor:', profesor);

      if (nuevoMat && nuevoNrc) {
        elemento.textContent = `${nuevoMat}\n${nuevoNrc}\n${nuevoProf}`;
        const nuevoColor = obtenerColorParaMateria(nuevoMat);
        elemento.style.backgroundColor = nuevoColor;
      }
    }
  </script>
</body>
</html>
